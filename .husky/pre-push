#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "Running pre-push checks..."

# Run all frontend checks
echo "ğŸ” Running frontend checks..."
npm run lint --workspace=client
if [ $? -ne 0 ]; then
  echo "âŒ Frontend linting failed"
  exit 1
fi

npm run build --workspace=client
if [ $? -ne 0 ]; then
  echo "âŒ Frontend build failed"
  exit 1
fi

# Run all backend checks
echo "ğŸ” Running backend checks..."
node --check server/src/server.js
if [ $? -ne 0 ]; then
  echo "âŒ Server syntax check failed"
  exit 1
fi

npm run test --workspace=server --if-present
if [ $? -ne 0 ]; then
  echo "âŒ Server tests failed"
  exit 1
fi

echo "âœ… All pre-push checks passed successfully!"
echo "ğŸš€ Ready to push to remote repository"